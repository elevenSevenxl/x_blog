const n=JSON.parse(`{"key":"v-3d7de086","path":"/vue/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD.html","title":"自定义指令实现图片懒加载","lang":"zh-CN","frontmatter":{"title":"自定义指令实现图片懒加载","cover":"/assets/images/cover28.jpg","isTimeLine":true,"date":"2023-10-08T00:00:00.000Z","footer":"<a href=\\"https://icp.gov.moe/?keyword=20231319\\" target=\\"_blank\\">萌 ICP 备 20231319 号</a>","copyright":"Copyright © 2023 没有蜡笔的小新","category":["vue"],"tag":["vue"],"description":"&lt;template&gt; &lt;div&gt; &lt;img v-lazy=\\"item\\" class=\\"img\\" width=\\"400\\" v-for=\\"item in arr\\" alt=\\"\\" :key=\\"item\\"&gt; &lt;/div&gt; &lt;/template&gt; &lt;script setup lang=\\"ts\\"&gt; // glob是懒加载的模式 // let modules = { // 'xxxx': () =&gt; import('xxx') // } // globEager静态加载 import xx from 'xxxx' import type { Directive } from 'vue' let imageList: Record&lt;string, {default: string}&gt; = i​mport.meta.glob('@/images/*.*', { eager: true }) let arr = Object.values(imageList).map(item =&gt; item.default) console.log(111111111111, arr); let vLazy: Directive&lt;HTMLImageElement, string&gt; = async (el, binding) =&gt; { const def = await import('@/assets/logo.svg') el.src = def.default // 监听可视区域 const observer = new IntersectionObserver((enr) =&gt; { console.log('监听的元素',enr); // intersectionRatio: 0 此属性的值为0说明元素还未出现 if (enr[0].intersectionRatio &gt; 0) { el.src = binding.value observer.unobserve(el) } }) observer.observe(el) console.log(el); } &lt;/script&gt; &lt;style&gt; .img { height: 500px; } &lt;/style&gt;","head":[["meta",{"property":"og:url","content":"https://elevenSevenxl.github.io/x_blog/vue/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4%E5%AE%9E%E7%8E%B0%E5%9B%BE%E7%89%87%E6%87%92%E5%8A%A0%E8%BD%BD.html"}],["meta",{"property":"og:site_name","content":"没有蜡笔的小新"}],["meta",{"property":"og:title","content":"自定义指令实现图片懒加载"}],["meta",{"property":"og:description","content":"&lt;template&gt; &lt;div&gt; &lt;img v-lazy=\\"item\\" class=\\"img\\" width=\\"400\\" v-for=\\"item in arr\\" alt=\\"\\" :key=\\"item\\"&gt; &lt;/div&gt; &lt;/template&gt; &lt;script setup lang=\\"ts\\"&gt; // glob是懒加载的模式 // let modules = { // 'xxxx': () =&gt; import('xxx') // } // globEager静态加载 import xx from 'xxxx' import type { Directive } from 'vue' let imageList: Record&lt;string, {default: string}&gt; = i​mport.meta.glob('@/images/*.*', { eager: true }) let arr = Object.values(imageList).map(item =&gt; item.default) console.log(111111111111, arr); let vLazy: Directive&lt;HTMLImageElement, string&gt; = async (el, binding) =&gt; { const def = await import('@/assets/logo.svg') el.src = def.default // 监听可视区域 const observer = new IntersectionObserver((enr) =&gt; { console.log('监听的元素',enr); // intersectionRatio: 0 此属性的值为0说明元素还未出现 if (enr[0].intersectionRatio &gt; 0) { el.src = binding.value observer.unobserve(el) } }) observer.observe(el) console.log(el); } &lt;/script&gt; &lt;style&gt; .img { height: 500px; } &lt;/style&gt;"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://elevenSevenxl.github.io/x_blog/assets/images/cover28.jpg"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-10-08T14:58:46.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:alt","content":"自定义指令实现图片懒加载"}],["meta",{"property":"article:author","content":"没有蜡笔的小新"}],["meta",{"property":"article:tag","content":"vue"}],["meta",{"property":"article:published_time","content":"2023-10-08T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-10-08T14:58:46.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"自定义指令实现图片懒加载\\",\\"image\\":[\\"https://elevenSevenxl.github.io/x_blog/assets/images/cover28.jpg\\"],\\"datePublished\\":\\"2023-10-08T00:00:00.000Z\\",\\"dateModified\\":\\"2023-10-08T14:58:46.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"没有蜡笔的小新\\",\\"url\\":\\"https://elevenSevenxl.github.io/x_blog\\"}]}"]]},"headers":[],"git":{"createdTime":1696777126000,"updatedTime":1696777126000,"contributors":[{"name":"yxl","email":"1551536781@qq.com","commits":1}]},"readingTime":{"minutes":0.68,"words":205},"filePathRelative":"vue/自定义指令实现图片懒加载.md","localizedDate":"2023年10月8日","excerpt":"<hr>\\n<div class=\\"language-javascript line-numbers-mode\\" data-ext=\\"js\\"><pre class=\\"language-javascript\\"><code><span class=\\"token operator\\">&lt;</span>template<span class=\\"token operator\\">&gt;</span>\\n  <span class=\\"token operator\\">&lt;</span>div<span class=\\"token operator\\">&gt;</span>\\n    <span class=\\"token operator\\">&lt;</span>img v<span class=\\"token operator\\">-</span>lazy<span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"item\\"</span> <span class=\\"token keyword\\">class</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"img\\"</span> width<span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"400\\"</span>  v<span class=\\"token operator\\">-</span><span class=\\"token keyword\\">for</span><span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"item in arr\\"</span> alt<span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"\\"</span> <span class=\\"token operator\\">:</span>key<span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"item\\"</span><span class=\\"token operator\\">&gt;</span>\\n  <span class=\\"token operator\\">&lt;</span><span class=\\"token operator\\">/</span>div<span class=\\"token operator\\">&gt;</span>\\n<span class=\\"token operator\\">&lt;</span><span class=\\"token operator\\">/</span>template<span class=\\"token operator\\">&gt;</span>\\n<span class=\\"token operator\\">&lt;</span>script setup lang<span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"ts\\"</span><span class=\\"token operator\\">&gt;</span>\\n<span class=\\"token comment\\">// glob是懒加载的模式</span>\\n<span class=\\"token comment\\">// let modules = {</span>\\n<span class=\\"token comment\\">//   'xxxx': () =&gt; import('xxx')</span>\\n<span class=\\"token comment\\">// }</span>\\n<span class=\\"token comment\\">// globEager静态加载  import xx from 'xxxx'</span>\\n<span class=\\"token keyword\\">import</span> type <span class=\\"token punctuation\\">{</span> Directive <span class=\\"token punctuation\\">}</span> <span class=\\"token keyword\\">from</span> <span class=\\"token string\\">'vue'</span>\\n<span class=\\"token keyword\\">let</span> <span class=\\"token literal-property property\\">imageList</span><span class=\\"token operator\\">:</span> Record<span class=\\"token operator\\">&lt;</span>string<span class=\\"token punctuation\\">,</span> <span class=\\"token punctuation\\">{</span><span class=\\"token keyword\\">default</span><span class=\\"token operator\\">:</span> string<span class=\\"token punctuation\\">}</span><span class=\\"token operator\\">&gt;</span> <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">import</span><span class=\\"token punctuation\\">.</span>meta<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">glob</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'@/images/*.*'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token punctuation\\">{</span> <span class=\\"token literal-property property\\">eager</span><span class=\\"token operator\\">:</span> <span class=\\"token boolean\\">true</span> <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span>\\n<span class=\\"token keyword\\">let</span> arr <span class=\\"token operator\\">=</span> Object<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">values</span><span class=\\"token punctuation\\">(</span>imageList<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">map</span><span class=\\"token punctuation\\">(</span><span class=\\"token parameter\\">item</span> <span class=\\"token operator\\">=&gt;</span> item<span class=\\"token punctuation\\">.</span>default<span class=\\"token punctuation\\">)</span>\\nconsole<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">log</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">111111111111</span><span class=\\"token punctuation\\">,</span> arr<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token keyword\\">let</span> <span class=\\"token literal-property property\\">vLazy</span><span class=\\"token operator\\">:</span> Directive<span class=\\"token operator\\">&lt;</span>HTMLImageElement<span class=\\"token punctuation\\">,</span> string<span class=\\"token operator\\">&gt;</span> <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">async</span> <span class=\\"token punctuation\\">(</span><span class=\\"token parameter\\">el<span class=\\"token punctuation\\">,</span> binding</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">=&gt;</span> <span class=\\"token punctuation\\">{</span>\\n  <span class=\\"token keyword\\">const</span> def <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">await</span> <span class=\\"token keyword\\">import</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'@/assets/logo.svg'</span><span class=\\"token punctuation\\">)</span>\\n  el<span class=\\"token punctuation\\">.</span>src <span class=\\"token operator\\">=</span> def<span class=\\"token punctuation\\">.</span>default\\n  <span class=\\"token comment\\">// 监听可视区域</span>\\n  <span class=\\"token keyword\\">const</span> observer <span class=\\"token operator\\">=</span> <span class=\\"token keyword\\">new</span> <span class=\\"token class-name\\">IntersectionObserver</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">(</span><span class=\\"token parameter\\">enr</span><span class=\\"token punctuation\\">)</span> <span class=\\"token operator\\">=&gt;</span> <span class=\\"token punctuation\\">{</span>\\n    console<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">log</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">'监听的元素'</span><span class=\\"token punctuation\\">,</span>enr<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>  <span class=\\"token comment\\">// intersectionRatio: 0  此属性的值为0说明元素还未出现</span>\\n    <span class=\\"token keyword\\">if</span> <span class=\\"token punctuation\\">(</span>enr<span class=\\"token punctuation\\">[</span><span class=\\"token number\\">0</span><span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">.</span>intersectionRatio <span class=\\"token operator\\">&gt;</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n      el<span class=\\"token punctuation\\">.</span>src <span class=\\"token operator\\">=</span> binding<span class=\\"token punctuation\\">.</span>value\\n      observer<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">unobserve</span><span class=\\"token punctuation\\">(</span>el<span class=\\"token punctuation\\">)</span>\\n    <span class=\\"token punctuation\\">}</span>\\n  <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span>\\n  observer<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">observe</span><span class=\\"token punctuation\\">(</span>el<span class=\\"token punctuation\\">)</span>\\n  console<span class=\\"token punctuation\\">.</span><span class=\\"token function\\">log</span><span class=\\"token punctuation\\">(</span>el<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n\\n<span class=\\"token punctuation\\">}</span>\\n<span class=\\"token operator\\">&lt;</span><span class=\\"token operator\\">/</span>script<span class=\\"token operator\\">&gt;</span>\\n<span class=\\"token operator\\">&lt;</span>style<span class=\\"token operator\\">&gt;</span>\\n<span class=\\"token punctuation\\">.</span>img <span class=\\"token punctuation\\">{</span>\\n  <span class=\\"token literal-property property\\">height</span><span class=\\"token operator\\">:</span> 500px<span class=\\"token punctuation\\">;</span>\\n<span class=\\"token punctuation\\">}</span>\\n<span class=\\"token operator\\">&lt;</span><span class=\\"token operator\\">/</span>style<span class=\\"token operator\\">&gt;</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}`);export{n as data};
